{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/rubva/Desktop/chat+app+source+code/chat app source code/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { take } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"./../../services/chat/chat.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@ionic/angular\";\nimport * as i5 from \"../../components/empty-screen/empty-screen.component\";\nimport * as i6 from \"../../components/user-list/user-list.component\";\nconst _c0 = [\"new_chat\"];\nconst _c1 = [\"popover\"];\nfunction HomePage_ng_template_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-content\", 19);\n    i0.ɵɵlistener(\"click\", function HomePage_ng_template_9_Template_ion_content_click_0_listener() {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.logout());\n    });\n    i0.ɵɵelementStart(1, \"ion-label\", 20);\n    i0.ɵɵtext(2, \" Cerrar Sesion \");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction HomePage_app_empty_screen_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-empty-screen\", 21);\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"model\", ctx_r2.model);\n  }\n}\nfunction HomePage_ng_container_23_ion_list_1_ion_item_3_ng_container_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"ion-avatar\", 25);\n    i0.ɵɵelement(2, \"img\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-label\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const user_r13 = ctx.ngIf;\n    const ctx_r12 = i0.ɵɵnextContext(4);\n    let tmp_0_0;\n    let tmp_1_0;\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", (tmp_0_0 = ctx_r12.getUser(user_r13)) == null ? null : tmp_0_0.photo, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", (tmp_1_0 = ctx_r12.getUser(user_r13)) == null ? null : tmp_1_0.name, \" \");\n  }\n}\nfunction HomePage_ng_container_23_ion_list_1_ion_item_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r15 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-item\", 24);\n    i0.ɵɵlistener(\"click\", function HomePage_ng_container_23_ion_list_1_ion_item_3_Template_ion_item_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r15);\n      const item_r11 = restoredCtx.$implicit;\n      const ctx_r14 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r14.getChat(item_r11));\n    });\n    i0.ɵɵtemplate(1, HomePage_ng_container_23_ion_list_1_ion_item_3_ng_container_1_Template, 5, 2, \"ng-container\", 13);\n    i0.ɵɵpipe(2, \"async\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r11 = ctx.$implicit;\n    i0.ɵɵproperty(\"detail\", true);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(2, 2, item_r11 == null ? null : item_r11.user));\n  }\n}\nfunction HomePage_ng_container_23_ion_list_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-list\")(1, \"ion-list-header\", 22);\n    i0.ɵɵtext(2, \" RECENT CHATS \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(3, HomePage_ng_container_23_ion_list_1_ion_item_3_Template, 3, 4, \"ion-item\", 23);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const rooms_r8 = i0.ɵɵnextContext().ngIf;\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", rooms_r8);\n  }\n}\nfunction HomePage_ng_container_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtemplate(1, HomePage_ng_container_23_ion_list_1_Template, 4, 1, \"ion-list\", 13);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const rooms_r8 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", (rooms_r8 == null ? null : rooms_r8.length) > 0);\n  }\n}\nfunction HomePage_ng_template_30_ion_content_7_app_user_list_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r22 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"app-user-list\", 30);\n    i0.ɵɵlistener(\"onClick\", function HomePage_ng_template_30_ion_content_7_app_user_list_2_Template_app_user_list_onClick_0_listener($event) {\n      i0.ɵɵrestoreView(_r22);\n      const ctx_r21 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r21.startChat($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const item_r20 = ctx.$implicit;\n    i0.ɵɵproperty(\"item\", item_r20);\n  }\n}\nfunction HomePage_ng_template_30_ion_content_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-content\", 11)(1, \"ion-list\", 28);\n    i0.ɵɵtemplate(2, HomePage_ng_template_30_ion_content_7_app_user_list_2_Template, 1, 1, \"app-user-list\", 29);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const user$_r18 = ctx.ngIf;\n    i0.ɵɵadvance(1);\n    i0.ɵɵstyleProp(\"background\", \"transparent\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", user$_r18);\n  }\n}\nfunction HomePage_ng_template_30_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r24 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"ion-header\")(1, \"ion-toolbar\", 1)(2, \"ion-title\");\n    i0.ɵɵtext(3, \"New Chat\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-buttons\", 2)(5, \"ion-button\", 15);\n    i0.ɵɵlistener(\"click\", function HomePage_ng_template_30_Template_ion_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r24);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.cancel());\n    });\n    i0.ɵɵtext(6, \"Cancel\");\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵtemplate(7, HomePage_ng_template_30_ion_content_7_Template, 3, 3, \"ion-content\", 27);\n    i0.ɵɵpipe(8, \"async\");\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngIf\", i0.ɵɵpipeBind1(8, 1, ctx_r5.users));\n  }\n}\nlet HomePage = /*#__PURE__*/(() => {\n  var _class;\n  class HomePage {\n    // users = [\n    //   {id: 1, name: 'NIkhil', photo: 'https://i.pravatar.cc/315'},\n    //   {id: 2, name: 'XYZ', photo: 'https://i.pravatar.cc/325'},\n    // ];\n    // chatRooms = [\n    //   {id: 1, name: 'NIkhil', photo: 'https://i.pravatar.cc/315'},\n    //   {id: 2, name: 'XYZ', photo: 'https://i.pravatar.cc/325'},\n    // ];\n    constructor(router, chatService) {\n      this.router = router;\n      this.chatService = chatService;\n      this.segment = 'chats';\n      this.open_new_chat = false;\n      this.model = {\n        icon: 'chatbubbles-outline',\n        title: 'No Chat Rooms',\n        color: 'danger'\n      };\n    }\n    ngOnInit() {\n      this.getRooms();\n    }\n    getRooms() {\n      // this.chatService.getId();\n      this.chatService.getChatRooms();\n      this.chatRooms = this.chatService.chatRooms;\n      console.log('chatrooms: ', this.chatRooms);\n    }\n    logout() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        try {\n          console.log('logout');\n          _this.popover.dismiss();\n          yield _this.chatService.auth.logout();\n          // this.chatService.currentUserId = null;\n          _this.router.navigateByUrl('/login', {\n            replaceUrl: true\n          });\n        } catch (e) {\n          console.log(e);\n        }\n      })();\n    }\n    onSegmentChanged(event) {\n      console.log(event);\n      this.segment = event.detail.value;\n    }\n    newChat() {\n      this.open_new_chat = true;\n      if (!this.users) this.getUsers();\n    }\n    getUsers() {\n      this.chatService.getUsers();\n      this.users = this.chatService.users;\n    }\n    onWillDismiss(event) {}\n    cancel() {\n      this.modal.dismiss();\n      this.open_new_chat = false;\n    }\n    startChat(item) {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        try {\n          // this.global.showLoader();\n          // create chatroom\n          const room = yield _this2.chatService.createChatRoom(item?.uid);\n          console.log('room: ', room);\n          _this2.cancel();\n          const navData = {\n            queryParams: {\n              name: item?.name\n            }\n          };\n          _this2.router.navigate(['/', 'home', 'chats', room?.id], navData);\n          // this.global.hideLoader();\n        } catch (e) {\n          console.log(e);\n          // this.global.hideLoader();\n        }\n      })();\n    }\n\n    getChat(item) {\n      (item?.user).pipe(take(1)).subscribe(user_data => {\n        console.log('data: ', user_data);\n        const navData = {\n          queryParams: {\n            name: user_data?.name\n          }\n        };\n        this.router.navigate(['/', 'home', 'chats', item?.id], navData);\n      });\n    }\n    getUser(user) {\n      return user;\n    }\n  }\n  _class = HomePage;\n  _class.ɵfac = function HomePage_Factory(t) {\n    return new (t || _class)(i0.ɵɵdirectiveInject(i1.Router), i0.ɵɵdirectiveInject(i2.ChatService));\n  };\n  _class.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _class,\n    selectors: [[\"app-home\"]],\n    viewQuery: function HomePage_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n        i0.ɵɵviewQuery(_c1, 5);\n      }\n      if (rf & 2) {\n        let _t;\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.modal = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.popover = _t.first);\n      }\n    },\n    decls: 31,\n    vars: 8,\n    consts: [[1, \"title-header\"], [\"color\", \"primary\"], [\"slot\", \"end\"], [\"fill\", \"clear\", \"id\", \"popover\"], [\"slot\", \"icon-only\", \"name\", \"ellipsis-vertical-outline\"], [\"trigger\", \"popover\", \"triggerAction\", \"click\"], [\"popover\", \"\"], [\"mode\", \"md\", 3, \"value\", \"ionChange\"], [\"value\", \"status\"], [\"value\", \"chats\"], [\"value\", \"calls\"], [\"color\", \"light\"], [3, \"model\", 4, \"ngIf\"], [4, \"ngIf\"], [\"slot\", \"fixed\", \"horizontal\", \"end\", \"vertical\", \"bottom\"], [3, \"click\"], [\"name\", \"add\"], [3, \"isOpen\", \"willDismiss\"], [\"new_chat\", \"\"], [1, \"ion-padding\", \"ion-text-center\", 3, \"click\"], [\"color\", \"danger\"], [3, \"model\"], [\"color\", \"light\", 1, \"ion-padding-bottom\"], [3, \"detail\", \"click\", 4, \"ngFor\", \"ngForOf\"], [3, \"detail\", \"click\"], [\"slot\", \"start\"], [3, \"src\"], [\"color\", \"light\", 4, \"ngIf\"], [\"lines\", \"none\", 1, \"ion-margin-top\"], [3, \"item\", \"onClick\", 4, \"ngFor\", \"ngForOf\"], [3, \"item\", \"onClick\"]],\n    template: function HomePage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\", 0)(1, \"ion-toolbar\", 1)(2, \"ion-title\");\n        i0.ɵɵtext(3, \"Chat App\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-buttons\", 2)(5, \"ion-button\", 3);\n        i0.ɵɵelement(6, \"ion-icon\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"ion-popover\", 5, 6);\n        i0.ɵɵtemplate(9, HomePage_ng_template_9_Template, 3, 0, \"ng-template\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(10, \"ion-segment\", 7);\n        i0.ɵɵlistener(\"ionChange\", function HomePage_Template_ion_segment_ionChange_10_listener($event) {\n          return ctx.onSegmentChanged($event);\n        });\n        i0.ɵɵelementStart(11, \"ion-segment-button\", 8)(12, \"ion-label\");\n        i0.ɵɵtext(13, \"Estado\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(14, \"ion-segment-button\", 9)(15, \"ion-label\");\n        i0.ɵɵtext(16, \"Chats\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(17, \"ion-segment-button\", 10)(18, \"ion-label\");\n        i0.ɵɵtext(19, \"Llamadas\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(20, \"ion-content\", 11);\n        i0.ɵɵtemplate(21, HomePage_app_empty_screen_21_Template, 1, 1, \"app-empty-screen\", 12);\n        i0.ɵɵpipe(22, \"async\");\n        i0.ɵɵtemplate(23, HomePage_ng_container_23_Template, 2, 1, \"ng-container\", 13);\n        i0.ɵɵpipe(24, \"async\");\n        i0.ɵɵelementStart(25, \"ion-fab\", 14)(26, \"ion-fab-button\", 15);\n        i0.ɵɵlistener(\"click\", function HomePage_Template_ion_fab_button_click_26_listener() {\n          return ctx.newChat();\n        });\n        i0.ɵɵelement(27, \"ion-icon\", 16);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(28, \"ion-modal\", 17, 18);\n        i0.ɵɵlistener(\"willDismiss\", function HomePage_Template_ion_modal_willDismiss_28_listener($event) {\n          return ctx.onWillDismiss($event);\n        });\n        i0.ɵɵtemplate(30, HomePage_ng_template_30_Template, 9, 3, \"ng-template\");\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        let tmp_1_0;\n        i0.ɵɵadvance(10);\n        i0.ɵɵproperty(\"value\", ctx.segment);\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngIf\", ((tmp_1_0 = i0.ɵɵpipeBind1(22, 4, ctx.chatRooms)) == null ? null : tmp_1_0.length) == 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.segment == \"chats\" && i0.ɵɵpipeBind1(24, 6, ctx.chatRooms));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"isOpen\", ctx.open_new_chat);\n      }\n    },\n    dependencies: [i3.NgForOf, i3.NgIf, i4.IonAvatar, i4.IonButton, i4.IonButtons, i4.IonContent, i4.IonFab, i4.IonFabButton, i4.IonHeader, i4.IonIcon, i4.IonItem, i4.IonLabel, i4.IonList, i4.IonListHeader, i4.IonSegment, i4.IonSegmentButton, i4.IonTitle, i4.IonToolbar, i4.IonModal, i4.IonPopover, i4.SelectValueAccessor, i5.EmptyScreenComponent, i6.UserListComponent, i3.AsyncPipe],\n    styles: [\"ion-header.title-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{font-family:Satisfy,cursive!important}ion-header.title-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{letter-spacing:2px;font-size:1.8rem!important}ion-header.title-header[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{--background: var(--ion-color-primary)}ion-header.title-header[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{font-size:1rem;--color: var(--ion-color-light);--color-checked: #fff}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-list-header[_ngcontent-%COMP%]{font-weight:600;font-size:1rem}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{margin-top:2vh}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:1.2rem}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:3px}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-size:.9rem}\"]\n  });\n  return HomePage;\n})();\nexport { HomePage };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}